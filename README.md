# request_generate
Генератор запросов на лиц для МВД

Системные требования:
Программа работает в любой операционной системе где установлены:
- интерпретатор python версии не ниже 3.0 скачать можно тут - www.python.org/download 
- расширение PyQt4, скачать можно отсюда - www.riverbankcomputing.com/software/pyqt/download
- дополнительная библиотека lxml (не обязательна но для правильной работы нужна)
(все установщики находятся в папке с программой после установки можно удалить)

ВНИМАНИЕ!
Шаблон запроса создан в Word 2013, посему при открытии созданного запроса в word 2007 наблюдается пропадание пробелов - пока не победил
временное решение: 
шаг 1. Откройте файл start.py (у кого нет расширения то просто start) в любом текстовом редакторе (например «Блокнот»).
шаг 2. Найдите и закомментируйте строки (поставить знак # в начале строки)
<code>try:</code>
<code>    from lxml import etree as ET</code>
<code>except ImportError:</code>
<code>    import xml.etree.ElementTree as ET</code>
шаг 3. раскоментируйте строку (удалите знак # вначале строки)
#import xml.etree.ElementTree as ET</code>
должно в итоге получиться что-то похожее на это:
<code>#try:</code>
<code>#    from lxml import etree as ET</code>
<code>#except ImportError:</code>
<code>#    import xml.etree.ElementTree as ET</code>
<code>import xml.etree.ElementTree as ET</code>
шаг 4. Сохраните файл программы.

Сгенерированные запросы будут создаваться нормально, но при открытии Word будет ругаться на ошибку xml-содержимого, игнорируем ее и просим все равно открыть файл восстановив его (ок -> да). Запрос откроется в новым документом (как шаблон). 
После его можно сохранить если нужен в будущем или не сохранять если не нужен.
В офисе ниже 2007 не пробовал. 
постоянное решение: Обновите microsoft office версией не ниже 2013

Установка и запуск:
Копируем папку с программой на компьютер. 
Для Windows:
Смотрим свойства системы (правый щелчок на значке «мой компьютер» («компьютер») пункт свойства контекстного меню) Если написано, что window 64-разрядная, то заходим в папку install -> x64, если windows 32-разрядная (еще называют х86) или не смогли разобраться с разрядностью заходим в папку install -> x86.
Из папки устанавливаем:
1.	Python 3.4....exe
2.	PyQt4 
3.	lxml

Описание программы и ее работы:
Программа предназначена для автоматического создания запросов характеризующего материала на лицо по уголовным делам с учетом требований приказа о документообороте в МВД РФ. в принципе возможно создание и других документов по шаблонам (пока работаю в этом направлении).

После первого запуска программа просит ввести данные подразделения, начальника, исполнителя запроса. 
Поля помеченные звездочкой (*) обязательны для заполнения! После заполнения жмем кнопку сохранить. Открывается главное окно программы. 

На вкладке "Служебные данные" находятся поля с данными для редактирования. Поля, помеченные звездочкой (*) обязательны для заполнения! Если чего-то не будет хватать, то программа попросит их заполнить до начала создания запросов. Заполнять нужно один раз в последующем данные сохраняются. 

На вкладке "Данные о лице" находятся данные по уголовному делу, лица.
поля, отмеченные звездочкой (*) обязательны для заполнения. После закрытия программы программа сохраняет данные о последнем введенном лице. поэтому будьте внимательны при заполнении. Если человек проживает не по месту регистрации, то снимаем галочку с соответствующего флажка и заполняем появившиеся поля.

На вкладке "запросы" располагаются сведения о запросах. После первого запуска будет 4 стандартных запроса:
- требование о судимости
- врач нарколог
- врач психолог
- военкомат
Если необходимо создать свой запрос в нижней части есть кнопка «Добавить запрос». Количество запросов теоретически не ограничено. Как будет практически покажет время. 
Для каждой организации можно создать свой запрос и выбирать по мере необходимости. 
Требование о судимости нельзя удалять, остальные все запросы можно (кнопка с крестиком). 
Все запросы можно редактировать. (кнопка с карандашом) При нажатии на нее откроется окно редактирования запроса. Поля отмеченные звездочкой (*) обязательны для заполнения. 

возможно сделаю перемещение названий запросов для сортировки, но пока в этом не вижу необходимости. 

Для создания запросов отмечаем чекбоксы необходимых запросов. Жмем самую нижнюю кнопку «создать запросы» после выполнения программа укажет количество созданных запросов.
Созданные запросы сохраняются в папку «запросы» в папке с программой по правилу:
- ФАМИЛИЯ по уд НОМЕР_ДЕЛА запрос в КУДА_ЗАПРОС.docx поэтому старайтесь краткое название запроса делать кратким.

Старался программу сделать интуитивно понятной, минималистичной но функциональной.

Программа распространяется как есть. Все права принадлежат мне. Регистрация не требуется.

Если на MAC коряво отображается служебные данные - данные для углового штампа откройте программу в любом текстовом редакторе
найдите строки #self.le_short_title_superior.setMinimumWidth(600) и раскоментируйте их (удалить знак - # перед текстом).

в папке patern (в windows скрыта) хранятся шаблоны запросов (настоятельно рекомендую без надобности туда не лезть). в папке images –картинки для кнопок. 
в файлах: setting - хранятся данные с вкладки служебная информация, person – данные о последнем лице, request – данные запросов. 
Если нужно распространить программу в пределах одного ОВД запустите программу, заполните начальные данные и отредактируйте запросы, выйдете из программы. Скопируйте папку с программой вместе с файлами setting и request. На новом месте все введенные данные будут уже заполнены. Для обнуления программы достаточно удалить файлы setting, request, person.

С уважением,
Андрей

andmoni@yandex.ru
